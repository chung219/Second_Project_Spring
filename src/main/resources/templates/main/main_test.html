<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="robots" content="ALL"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>외식업 프랜차이즈 현황</title>
    <meta name="Description" content="우리동네 외식업 프랜차이즈에 대한 다양한 정보를 제공합니다."/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=0.1,maximum-scale=5.0,user-scalable=yes" />
    <link rel="stylesheet" type="text/css" href="/css/reset.css" >
    <link rel="stylesheet" type="text/css" href="/css/layout.css" >
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">
    <script src="js/jquery.js"></script>
    <script src="js/jquery-ui-1.10.4.custom.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=3fa5806dfe291fb3622cf85fca14b017&libraries=services,clusterer,drawing"></script>
</head>
<body class="main">
<div class="container">
    <!-- ####### 01. HEADER START ####### -->
    <div class="header_wrap">
        <header>
            <h1><a href="/">전국 프랜차이즈 가맹현황</a></h1>
            <nav>
                <ul>
                    <li><a href="category">업종별</a></li>
                    <li><a href="brand">브랜드별</a></li>
                    <li><a href="region">지역별</a></li>
                    <li><a href="region" class="fa fa-search" title="검색"> </a></li>
                </ul>
            </nav>
        </header>
    </div>
    <!-- ####### 01. HEADER END ####### -->
    <hr class="skip"/>
    <!-- ####### 02. LNB START ######### -->
    <div class="lnb_wrap">
        <!-- #### 02-1. 좌측 고정 업종별 아이콘 메뉴 시작 -->
        <dl class="fixed_quick_menu">
            <dt class="fa fa-pie-chart" title="외식업종"></dt>
            <dd><a href="javacsript:void(0)" onclick="toggleMarkers()")>한식</a></dd>
<!--            <dd><a href="category/한식">한식</a></dd>-->
            <dd><a href="category/한식">중식</a></dd>
            <dd><a href="category/한식">일식</a></dd>
            <dd><a href="category/한식">양식</a></dd>
            <dd><a href="category/한식">치킨</a></dd>
            <dd><a href="category/한식">주점</a></dd>
            <dd><a href="category/한식">분식</a></dd>
            <dd><a href="category/한식">피자</a></dd>
            <dd><a href="category/한식">커피</a></dd>
            <dd><a href="category/한식">제과<br/>제빵</a></dd>
            <dd><a href="category/한식">패스트푸드</a></dd>
            <dd><a href="category/한식">음료<br/>(커피)</a></dd>
            <dd><a href="category/한식">아이스크림<br/>(빙수)</a></dd>
            <dd><a href="category/한식">기타<br/> 외국식</a></dd>
            <dd><a href="category/한식">기타<br/>외식</a></dd>
            <dd><a href="javacsript:void(0)" onclick="setOverlayMapTypeId('traffic')")>도로<br/>정보</a></dd>
        </dl>
        <!-- #### 02-1. 좌측 고정 업종별 아이콘 메뉴 끝 -->
        <hr class="skip"/>
        <!-- #### 02-2. 좌측 on/off 페이지 서브 메뉴 노출 시작 -->
        <div class="lnb">
            <div class="btn_lnb_open"><a href="#" class="fa fa-chevron-left"></a></div>
            <!-- 02-2-1. 대시보드 집계 그래프 노출 영역 시작 -->
            <h2>[외식] 업종별 가맹점 분포</h2>
            <div class="dash_board_graph">
                그래프가 들어갑니다!
            </div>
            <!-- 02-2-1.대시보드 집계 그래프 노출 영역 끝 -->
            <!-- 02-2-2.페이지 컨텐츠 서브 메뉴 노출 시작 -->
            <dl class="latest">
                <dt>[한식] 가맹점수 TOP3</dt>
                <dd>
                    <ol>
                        <li>
                            <a href="#">
                                <span class="thumb_img"></span>
                                <span class="brand_name">마을회관 왕갈비 일산점</span>
                                <b class="num fa fa-bookmark-o"> 1230</b>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <span class="thumb_img"></span>
                                <span class="brand_name">놀부보쌈 을왕리 해수욕장에서 제일 맛있는 집</span>
                                <b class="num fa fa-bookmark-o"> 105</b>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <span class="thumb_img"></span>
                                <span class="brand_name">여름이면 비냉/물냉이 최고 인하대점</span>
                                <b class="num fa fa-bookmark-o"> 78</b>
                            </a>
                        </li>
                    </ol>
                </dd>
                <dd><a href="#" class="btn_more">더보기</a></dd>
            </dl>
            <!-- 02-2-2.페이지 컨텐츠 서브 메뉴 노출 끝 -->
        </div>

        <!-- #### 02-2 좌측 on/off 페이지 서브 메뉴 노출 끝 -->
    </div>
    <!-- ####### 02. LNB END ########## -->
    <hr class="skip"/>
    <!-- ####### 03. CONTENTS START ####### -->
    <section class="contents_wrap">
        <!-- #### 03-1.우측 본문 영역 시작 -->
        <div class="right_contents">
            <!-- ######## 각 페이지에 해당 하는 내용 HTML을 넣어주세요.########### -->
                <div id="map"></div>
                <script th:inline="javascript">
                    var mapContainer = document.getElementById('map'), // 지도를 표시할 div
                        mapOption = {
                            center: new kakao.maps.LatLng(36.01683146793617, 129.42603381793853), // 지도의 중심좌표
                            level: 13 // 지도의 확대 레벨
                        };
                    // 지도를 생성합니다
                    var map = new kakao.maps.Map(mapContainer, mapOption);

                    // 지도에 추가된 지도타입정보를 가지고 있을 변수입니다
                    var currentTypeId;

                    // 버튼이 클릭되면 호출되는 함수입니다
                    function setOverlayMapTypeId(maptype) {
                        // 현재 지도 타입이 교통정보인지 확인합니다
                        var isTrafficType = currentTypeId === kakao.maps.MapTypeId.TRAFFIC;

                        if (maptype === 'traffic') {
                            // 현재 지도 타입이 교통정보이면 껐다 켭니다
                            if (isTrafficType) {
                                map.removeOverlayMapTypeId(kakao.maps.MapTypeId.TRAFFIC);
                                currentTypeId = null;
                            } else {
                                // 교통정보 지도타입을 추가합니다
                                map.addOverlayMapTypeId(kakao.maps.MapTypeId.TRAFFIC);
                                currentTypeId = kakao.maps.MapTypeId.TRAFFIC;
                            }
                        }
                    }

                    // // 지도에 교통정보를 표시하도록 지도타입을 추가합니다
                    // map.addOverlayMapTypeId(kakao.maps.MapTypeId.TRAFFIC);

                    // 일반 지도와 스카이뷰로 지도 타입을 전환할 수 있는 지도타입 컨트롤을 생성합니다
                    var mapTypeControl = new kakao.maps.MapTypeControl();

                    // 지도에 컨트롤을 추가해야 지도위에 표시됩니다
                    // kakao.maps.ControlPosition은 컨트롤이 표시될 위치를 정의하는데 TOPRIGHT는 오른쪽 위를 의미합니다
                    map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);

                    // 지도 확대 축소를 제어할 수 있는  줌 컨트롤을 생성합니다
                    var zoomControl = new kakao.maps.ZoomControl();
                    map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);

                    // 주소-좌표 변환 객체를 생성합니다
                    var geocoder = new kakao.maps.services.Geocoder();




                    var add_list = [[${address}]];
                    console.log(add_list)

                    var markers = []



                    add_list.forEach(function (address) {

                        var first_address = address.add1
                        var name = address.name

                        // 주소로 좌표를 검색합니다
                        geocoder.addressSearch(first_address, function (result, status) {

                            // 정상적으로 검색이 완료됐으면
                            if (status === kakao.maps.services.Status.OK) {

                                var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                                // 결과값으로 받은 위치를 마커로 표시합니다
                                var marker = new kakao.maps.Marker({
                                    map: map,
                                    position: coords,
                                });

                                markers.push(marker)

                                // 마커에 표시할 인포윈도우를 생성합니다
                                var infowindow = new kakao.maps.InfoWindow({
                                    content: '<div style="padding:5px;">'+name+'</div>' // 인포윈도우에 표시할 내용
                                });

                                // 마커에 이벤트를 등록하는 함수 만들고 즉시 호출하여 클로저를 만듭니다
                                // 클로저를 만들어 주지 않으면 마지막 마커에만 이벤트가 등록됩니다
                                (function(marker, infowindow) {
                                    // 마커에 mouseover 이벤트를 등록하고 마우스 오버 시 인포윈도우를 표시합니다
                                    kakao.maps.event.addListener(marker, 'mouseover', function() {
                                        infowindow.open(map, marker);
                                    });

                                    // 마커에 mouseout 이벤트를 등록하고 마우스 아웃 시 인포윈도우를 닫습니다
                                    kakao.maps.event.addListener(marker, 'mouseout', function() {
                                        infowindow.close();
                                    });
                                })(marker, infowindow);

                            }
                        });

                    });
                    // 배열에 추가된 마커들을 지도에 표시하거나 삭제하는 함수입니다
                    function setMarkers(map) {
                        for (var i = 0; i < markers.length; i++) {
                            markers[i].setMap(map);
                        }
                    }

                    // "마커 보이기" 버튼을 클릭하면 호출되어 배열에 추가된 마커를 지도에 표시하는 함수입니다
                    function showMarkers() {
                        setMarkers(map)
                    }

                    // "마커 감추기" 버튼을 클릭하면 호출되어 배열에 추가된 마커를 지도에서 삭제하는 함수입니다
                    function hideMarkers() {
                        setMarkers(null);
                    }
                    var isMarkersVisible = false; // 초기 상태는 마커가 보이지 않는 상태입니다

                    // 토글 버튼을 클릭했을 때 호출되는 함수입니다
                    function toggleMarkers() {
                        if (isMarkersVisible) {
                            hideMarkers(); // 마커가 보이는 상태라면 숨깁니다
                        } else {
                            showMarkers(); // 마커가 보이지 않는 상태라면 표시합니다
                        }

                        isMarkersVisible = !isMarkersVisible; // 상태를 토글합니다
                    }
                </script>


            <!-- ######## 각 페이지에 해당 하는 내용 HTML을 넣어주세요.########### -->
        </div>
        <!-- #### 03-1.우측 본문 영역 끝 -->
    </section>
    <!-- ####### 03. CONTENTS END ####### -->
    <hr class="skip"/>
    <!-- ####### 04. FOOTER START ####### -->
    <div class="footer_wrap">
        <footer>
            <p class="copyright">  © TEAM 8090  <a href="#" class="fa  fa-chevron-circle-up"> TOP</a></p>

        </footer>
    </div>
    <!-- ####### 04. FOOTER END ####### -->
</div>

</body>
</html>